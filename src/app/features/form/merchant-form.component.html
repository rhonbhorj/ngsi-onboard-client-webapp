<div class="min-h-screen bg-netpay-light-gray py-4 px-4 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="max-w-4xl mx-auto mb-8">
    <div class="text-center bg-white rounded-lg shadow-sm p-6 border border-gray-200">
      <div class="flex items-center justify-center mb-4">
        <div class="w-12 h-12 rounded-lg flex items-center justify-center mr-4">
          <img src="images/ngsi-logo.png" alt="Netpay Logo" class="w-12 h-12" />
        </div>
        <div>
          <h1 class="text-2xl sm:text-3xl font-bold text-netpay-dark-blue">
            Netpay Merchant Onboarding
          </h1>
          <p class="text-gray-600 mt-1">Complete your registration to start accepting payments</p>
        </div>
      </div>

      <!-- Progress Steps -->
      <div class="mt-6">
        <div class="flex items-center justify-center space-x-2 sm:space-x-4">
          <div *ngFor="let step of steps; let i = index" class="flex items-center">
            <div class="flex flex-col items-center">
              <div
                class="w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center text-sm font-semibold transition-colors duration-300"
                [class.bg-netpay-primary-blue]="i <= activeIndex"
                [class.text-white]="i <= activeIndex"
                [class.bg-gray-300]="i > activeIndex"
                [class.text-gray-600]="i > activeIndex"
              >
                {{ i + 1 }}
              </div>
              <span
                class="hidden sm:block text-xs mt-2 text-center font-medium"
                [class.text-netpay-primary-blue]="i <= activeIndex"
                [class.text-gray-500]="i > activeIndex"
              >
                {{ step }}
              </span>
            </div>
            <div
              *ngIf="i < steps.length - 1"
              class="w-8 sm:w-16 h-1 mx-2"
              [class.bg-netpay-primary-blue]="i < activeIndex"
              [class.bg-gray-300]="i >= activeIndex"
            ></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Form Container -->
  <div class="max-w-4xl mx-auto">
    <div class="bg-white rounded-lg shadow-lg border-0 p-6">
      <div *ngIf="!isLoading; else loadingTemplate">
        <!-- Step 1: Business Information -->
        <div *ngIf="activeIndex === 0" class="form-step">
          <h2 class="text-xl font-semibold text-netpay-dark-blue mb-6 flex items-center">
            <svg
              class="w-5 h-5 mr-2 text-netpay-primary-blue"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
              ></path>
            </svg>
            Business Information
          </h2>

          <form [formGroup]="businessInfoForm" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="form-field">
                <label for="businessName" class="block text-sm font-medium text-gray-700 mb-2">
                  Business Name *
                </label>
                <input
                  type="text"
                  id="businessName"
                  formControlName="businessName"
                  placeholder="Enter your business name"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(businessInfoForm, 'businessName')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(businessInfoForm, 'businessName')">
                  {{ getFieldError(businessInfoForm, 'businessName') }}
                </div>
              </div>

              <div class="form-field">
                <label for="businessType" class="block text-sm font-medium text-gray-700 mb-2">
                  Business Type *
                </label>
                <select
                  id="businessType"
                  formControlName="businessType"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(businessInfoForm, 'businessType')"
                >
                  <option value="">Select business type</option>
                  <option *ngFor="let type of businessTypes" [value]="type.value">
                    {{ type.label }}
                  </option>
                </select>
                <div class="error-message" *ngIf="isFieldInvalid(businessInfoForm, 'businessType')">
                  {{ getFieldError(businessInfoForm, 'businessType') }}
                </div>
              </div>

              <div class="form-field">
                <label for="businessCategory" class="block text-sm font-medium text-gray-700 mb-2">
                  Business Category *
                </label>
                <select
                  id="businessCategory"
                  formControlName="businessCategory"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(businessInfoForm, 'businessCategory')"
                >
                  <option value="">Select business category</option>
                  <option *ngFor="let category of businessCategories" [value]="category.value">
                    {{ category.label }}
                  </option>
                </select>
                <div
                  class="error-message"
                  *ngIf="isFieldInvalid(businessInfoForm, 'businessCategory')"
                >
                  {{ getFieldError(businessInfoForm, 'businessCategory') }}
                </div>
              </div>

              <div class="form-field">
                <label
                  for="registrationNumber"
                  class="block text-sm font-medium text-gray-700 mb-2"
                >
                  Business Registration Number *
                </label>
                <input
                  type="text"
                  id="registrationNumber"
                  formControlName="registrationNumber"
                  placeholder="Enter registration number"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(businessInfoForm, 'registrationNumber')"
                />
                <div
                  class="error-message"
                  *ngIf="isFieldInvalid(businessInfoForm, 'registrationNumber')"
                >
                  {{ getFieldError(businessInfoForm, 'registrationNumber') }}
                </div>
              </div>

              <div class="form-field">
                <label for="taxId" class="block text-sm font-medium text-gray-700 mb-2">
                  title placeholder*
                </label>
                <input
                  type="text"
                  id="taxId"
                  formControlName="taxId"
                  placeholder="enter a text"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(businessInfoForm, 'taxId')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(businessInfoForm, 'taxId')">
                  {{ getFieldError(businessInfoForm, 'taxId') }}
                </div>
              </div>

              <div class="form-field">
                <label for="yearEstablished" class="block text-sm font-medium text-gray-700 mb-2">
                  ang pogi ko *
                </label>
                <input
                  type="number"
                  id="yearEstablished"
                  formControlName="yearEstablished"
                  placeholder="ang pogi ko"
                  min="1800"
                  max="2024"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(businessInfoForm, 'yearEstablished')"
                />
                <div
                  class="error-message"
                  *ngIf="isFieldInvalid(businessInfoForm, 'yearEstablished')"
                >
                  {{ getFieldError(businessInfoForm, 'yearEstablished') }}
                </div>
              </div>

              <div class="form-field">
                <label for="numberOfEmployees" class="block text-sm font-medium text-gray-700 mb-2">
                  ang pogi ni raven *
                </label>
                <select
                  id="numberOfEmployees"
                  formControlName="numberOfEmployees"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(businessInfoForm, 'numberOfEmployees')"
                >
                  <option value="">ang pogi ni raven</option>
                  <option *ngFor="let range of employeeRanges" [value]="range.value">
                    {{ range.label }}
                  </option>
                </select>
                <div
                  class="error-message"
                  *ngIf="isFieldInvalid(businessInfoForm, 'numberOfEmployees')"
                >
                  {{ getFieldError(businessInfoForm, 'numberOfEmployees') }}
                </div>
              </div>

              <div class="form-field">
                <label for="website" class="block text-sm font-medium text-gray-700 mb-2">
                  Website URL (optional)
                </label>
                <input
                  type="url"
                  id="website"
                  formControlName="website"
                  placeholder="https://www.example.com"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                />
              </div>
            </div>

            <div class="form-field">
              <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                ge gawin mo *
              </label>
              <textarea
                id="description"
                formControlName="description"
                placeholder="Describe your business, products, and services..."
                rows="4"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                [class.border-red-500]="isFieldInvalid(businessInfoForm, 'description')"
              >
              </textarea>
              <div class="error-message" *ngIf="isFieldInvalid(businessInfoForm, 'description')">
                {{ getFieldError(businessInfoForm, 'description') }}
              </div>
            </div>
          </form>
        </div>

        <!-- Step 2: Business Address -->
        <div *ngIf="activeIndex === 1" class="form-step">
          <h2 class="text-xl font-semibold text-netpay-dark-blue mb-6 flex items-center">
            <svg
              class="w-5 h-5 mr-2 text-netpay-primary-blue"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
              ></path>
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
              ></path>
            </svg>
            Business Address
          </h2>

          <form [formGroup]="addressForm" class="space-y-6">
            <div class="form-field">
              <label for="street" class="block text-sm font-medium text-gray-700 mb-2">
                Street Address *
              </label>
              <input
                type="text"
                id="street"
                formControlName="street"
                placeholder="Enter street address"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                [class.border-red-500]="isFieldInvalid(addressForm, 'street')"
              />
              <div class="error-message" *ngIf="isFieldInvalid(addressForm, 'street')">
                {{ getFieldError(addressForm, 'street') }}
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="form-field">
                <label for="city" class="block text-sm font-medium text-gray-700 mb-2">
                  City *
                </label>
                <input
                  type="text"
                  id="city"
                  formControlName="city"
                  placeholder="Enter city"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(addressForm, 'city')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(addressForm, 'city')">
                  {{ getFieldError(addressForm, 'city') }}
                </div>
              </div>

              <div class="form-field">
                <label for="state" class="block text-sm font-medium text-gray-700 mb-2">
                  State/Province *
                </label>
                <input
                  type="text"
                  id="state"
                  formControlName="state"
                  placeholder="Enter state/province"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(addressForm, 'state')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(addressForm, 'state')">
                  {{ getFieldError(addressForm, 'state') }}
                </div>
              </div>

              <div class="form-field">
                <label for="postalCode" class="block text-sm font-medium text-gray-700 mb-2">
                  Postal Code *
                </label>
                <input
                  type="text"
                  id="postalCode"
                  formControlName="postalCode"
                  placeholder="Enter postal code"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(addressForm, 'postalCode')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(addressForm, 'postalCode')">
                  {{ getFieldError(addressForm, 'postalCode') }}
                </div>
              </div>

              <div class="form-field">
                <label for="country" class="block text-sm font-medium text-gray-700 mb-2">
                  Country *
                </label>
                <select
                  id="country"
                  formControlName="country"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(addressForm, 'country')"
                >
                  <option value="">Select country</option>
                  <option *ngFor="let country of countries" [value]="country.value">
                    {{ country.label }}
                  </option>
                </select>
                <div class="error-message" *ngIf="isFieldInvalid(addressForm, 'country')">
                  {{ getFieldError(addressForm, 'country') }}
                </div>
              </div>
            </div>
          </form>
        </div>

        <!-- Step 3: Contact Information -->
        <div *ngIf="activeIndex === 2" class="form-step">
          <h2 class="text-xl font-semibold text-netpay-dark-blue mb-6 flex items-center">
            <svg
              class="w-5 h-5 mr-2 text-netpay-primary-blue"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
              ></path>
            </svg>
            Contact Information
          </h2>

          <form [formGroup]="contactForm" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="form-field">
                <label for="firstName" class="block text-sm font-medium text-gray-700 mb-2">
                  First Name *
                </label>
                <input
                  type="text"
                  id="firstName"
                  formControlName="firstName"
                  placeholder="Enter first name"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(contactForm, 'firstName')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(contactForm, 'firstName')">
                  {{ getFieldError(contactForm, 'firstName') }}
                </div>
              </div>

              <div class="form-field">
                <label for="lastName" class="block text-sm font-medium text-gray-700 mb-2">
                  Last Name *
                </label>
                <input
                  type="text"
                  id="lastName"
                  formControlName="lastName"
                  placeholder="Enter last name"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(contactForm, 'lastName')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(contactForm, 'lastName')">
                  {{ getFieldError(contactForm, 'lastName') }}
                </div>
              </div>

              <div class="form-field">
                <label for="position" class="block text-sm font-medium text-gray-700 mb-2">
                  Position/Title *
                </label>
                <input
                  type="text"
                  id="position"
                  formControlName="position"
                  placeholder="Enter position/title"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(contactForm, 'position')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(contactForm, 'position')">
                  {{ getFieldError(contactForm, 'position') }}
                </div>
              </div>

              <div class="form-field">
                <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                  Email Address *
                </label>
                <input
                  type="email"
                  id="email"
                  formControlName="email"
                  placeholder="Enter email address"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(contactForm, 'email')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(contactForm, 'email')">
                  {{ getFieldError(contactForm, 'email') }}
                </div>
              </div>

              <div class="form-field">
                <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
                  Phone Number *
                </label>
                <input
                  type="tel"
                  id="phone"
                  formControlName="phone"
                  placeholder="Enter phone number"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(contactForm, 'phone')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(contactForm, 'phone')">
                  {{ getFieldError(contactForm, 'phone') }}
                </div>
              </div>

              <div class="form-field">
                <label for="alternatePhone" class="block text-sm font-medium text-gray-700 mb-2">
                  Alternate Phone
                </label>
                <input
                  type="tel"
                  id="alternatePhone"
                  formControlName="alternatePhone"
                  placeholder="Enter alternate phone"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(contactForm, 'alternatePhone')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(contactForm, 'alternatePhone')">
                  {{ getFieldError(contactForm, 'alternatePhone') }}
                </div>
              </div>
            </div>
          </form>
        </div>

        <!-- Step 4: Banking Information -->
        <div *ngIf="activeIndex === 3" class="form-step">
          <h2 class="text-xl font-semibold text-netpay-dark-blue mb-6 flex items-center">
            <svg
              class="w-5 h-5 mr-2 text-netpay-primary-blue"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"
              ></path>
            </svg>
            Banking Information
          </h2>

          <form [formGroup]="bankingForm" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="form-field">
                <label for="bankName" class="block text-sm font-medium text-gray-700 mb-2">
                  Bank Name *
                </label>
                <input
                  type="text"
                  id="bankName"
                  formControlName="bankName"
                  placeholder="Enter bank name"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(bankingForm, 'bankName')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(bankingForm, 'bankName')">
                  {{ getFieldError(bankingForm, 'bankName') }}
                </div>
              </div>

              <div class="form-field">
                <label for="accountType" class="block text-sm font-medium text-gray-700 mb-2">
                  Account Type *
                </label>
                <select
                  id="accountType"
                  formControlName="accountType"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(bankingForm, 'accountType')"
                >
                  <option value="">Select account type</option>
                  <option *ngFor="let type of accountTypes" [value]="type.value">
                    {{ type.label }}
                  </option>
                </select>
                <div class="error-message" *ngIf="isFieldInvalid(bankingForm, 'accountType')">
                  {{ getFieldError(bankingForm, 'accountType') }}
                </div>
              </div>

              <div class="form-field">
                <label for="accountNumber" class="block text-sm font-medium text-gray-700 mb-2">
                  Account Number *
                </label>
                <input
                  type="text"
                  id="accountNumber"
                  formControlName="accountNumber"
                  placeholder="Enter account number"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(bankingForm, 'accountNumber')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(bankingForm, 'accountNumber')">
                  {{ getFieldError(bankingForm, 'accountNumber') }}
                </div>
              </div>

              <div class="form-field">
                <label for="routingNumber" class="block text-sm font-medium text-gray-700 mb-2">
                  Routing Number *
                </label>
                <input
                  type="text"
                  id="routingNumber"
                  formControlName="routingNumber"
                  placeholder="Enter routing number"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(bankingForm, 'routingNumber')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(bankingForm, 'routingNumber')">
                  {{ getFieldError(bankingForm, 'routingNumber') }}
                </div>
              </div>

              <div class="form-field md:col-span-2">
                <label for="accountHolderName" class="block text-sm font-medium text-gray-700 mb-2">
                  Account Holder Name *
                </label>
                <input
                  type="text"
                  id="accountHolderName"
                  formControlName="accountHolderName"
                  placeholder="Enter account holder name"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-netpay-primary-blue focus:border-transparent"
                  [class.border-red-500]="isFieldInvalid(bankingForm, 'accountHolderName')"
                />
                <div class="error-message" *ngIf="isFieldInvalid(bankingForm, 'accountHolderName')">
                  {{ getFieldError(bankingForm, 'accountHolderName') }}
                </div>
              </div>
            </div>
          </form>
        </div>

        <!-- Step 5: Document Upload -->
        <div *ngIf="activeIndex === 4" class="form-step">
          <h2 class="text-xl font-semibold text-netpay-dark-blue mb-6 flex items-center">
            <svg
              class="w-5 h-5 mr-2 text-netpay-primary-blue"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
              ></path>
            </svg>
            Required Documents
          </h2>

          <form [formGroup]="documentsForm" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="form-field">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  Business License *
                </label>
                <div
                  class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-netpay-primary-blue transition-colors"
                >
                  <input
                    type="file"
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelect($event, 'businessLicense')"
                    class="hidden"
                    #businessLicenseInput
                  />
                  <button
                    type="button"
                    (click)="businessLicenseInput.click()"
                    class="bg-netpay-primary-blue text-white px-4 py-2 rounded-lg hover:bg-netpay-accent-blue transition-colors"
                  >
                    Choose File
                  </button>
                  <p class="text-sm text-gray-500 mt-2">PDF, JPG, PNG (max 5MB)</p>
                  <p *ngIf="uploadedFiles['businessLicense']" class="text-sm text-netpay-teal mt-2">
                    {{ uploadedFiles['businessLicense'].name }}
                  </p>
                </div>
              </div>

              <div class="form-field">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  Tax Certificate *
                </label>
                <div
                  class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-netpay-primary-blue transition-colors"
                >
                  <input
                    type="file"
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelect($event, 'taxCertificate')"
                    class="hidden"
                    #taxCertificateInput
                  />
                  <button
                    type="button"
                    (click)="taxCertificateInput.click()"
                    class="bg-netpay-primary-blue text-white px-4 py-2 rounded-lg hover:bg-netpay-accent-blue transition-colors"
                  >
                    Choose File
                  </button>
                  <p class="text-sm text-gray-500 mt-2">PDF, JPG, PNG (max 5MB)</p>
                  <p *ngIf="uploadedFiles['taxCertificate']" class="text-sm text-netpay-teal mt-2">
                    {{ uploadedFiles['taxCertificate'].name }}
                  </p>
                </div>
              </div>

              <div class="form-field">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  Bank Statement *
                </label>
                <div
                  class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-netpay-primary-blue transition-colors"
                >
                  <input
                    type="file"
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelect($event, 'bankStatement')"
                    class="hidden"
                    #bankStatementInput
                  />
                  <button
                    type="button"
                    (click)="bankStatementInput.click()"
                    class="bg-netpay-primary-blue text-white px-4 py-2 rounded-lg hover:bg-netpay-accent-blue transition-colors"
                  >
                    Choose File
                  </button>
                  <p class="text-sm text-gray-500 mt-2">PDF, JPG, PNG (max 5MB)</p>
                  <p *ngIf="uploadedFiles['bankStatement']" class="text-sm text-netpay-teal mt-2">
                    {{ uploadedFiles['bankStatement'].name }}
                  </p>
                </div>
              </div>

              <div class="form-field">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  Identity Document *
                </label>
                <div
                  class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-netpay-primary-blue transition-colors"
                >
                  <input
                    type="file"
                    accept=".pdf,.jpg,.jpeg,.png"
                    (change)="onFileSelect($event, 'identityDocument')"
                    class="hidden"
                    #identityDocumentInput
                  />
                  <button
                    type="button"
                    (click)="identityDocumentInput.click()"
                    class="bg-netpay-primary-blue text-white px-4 py-2 rounded-lg hover:bg-netpay-accent-blue transition-colors"
                  >
                    Choose File
                  </button>
                  <p class="text-sm text-gray-500 mt-2">PDF, JPG, PNG (max 5MB)</p>
                  <p
                    *ngIf="uploadedFiles['identityDocument']"
                    class="text-sm text-netpay-teal mt-2"
                  >
                    {{ uploadedFiles['identityDocument'].name }}
                  </p>
                </div>
              </div>
            </div>
          </form>
        </div>

        <!-- Step 6: Review & Agreements -->
        <div *ngIf="activeIndex === 5" class="form-step">
          <h2 class="text-xl font-semibold text-netpay-dark-blue mb-6 flex items-center">
            <svg
              class="w-5 h-5 mr-2 text-netpay-primary-blue"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
              ></path>
            </svg>
            Review & Agreements
          </h2>

          <div class="space-y-6">
            <!-- Summary -->
            <div class="bg-gray-50 rounded-lg p-6">
              <h3 class="font-semibold text-gray-800 mb-4">Application Summary</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                <div>
                  <span class="text-gray-600">Business Name:</span>
                  <span class="ml-2 font-medium">{{
                    businessInfoForm.get('businessName')?.value
                  }}</span>
                </div>
                <div>
                  <span class="text-gray-600">Business Type:</span>
                  <span class="ml-2 font-medium">{{
                    businessInfoForm.get('businessType')?.value
                  }}</span>
                </div>
                <div>
                  <span class="text-gray-600">Email:</span>
                  <span class="ml-2 font-medium">{{ contactForm.get('email')?.value }}</span>
                </div>
                <div>
                  <span class="text-gray-600">Phone:</span>
                  <span class="ml-2 font-medium">{{ contactForm.get('phone')?.value }}</span>
                </div>
              </div>
            </div>

            <!-- Agreements -->
            <form [formGroup]="agreementsForm" class="space-y-4">
              <div class="space-y-4">
                <label class="flex items-start space-x-3">
                  <input
                    type="checkbox"
                    formControlName="termsAccepted"
                    class="mt-1 h-5 w-5 text-netpay-primary-blue border-gray-300 rounded focus:ring-netpay-primary-blue"
                  />
                  <span class="text-sm text-gray-700">
                    I agree to the
                    <a href="#" class="text-netpay-primary-blue hover:underline"
                      >Terms and Conditions</a
                    >
                    *
                  </span>
                </label>
                <div class="error-message" *ngIf="isFieldInvalid(agreementsForm, 'termsAccepted')">
                  {{ getFieldError(agreementsForm, 'termsAccepted') }}
                </div>

                <label class="flex items-start space-x-3">
                  <input
                    type="checkbox"
                    formControlName="privacyPolicyAccepted"
                    class="mt-1 h-5 w-5 text-netpay-primary-blue border-gray-300 rounded focus:ring-netpay-primary-blue"
                  />
                  <span class="text-sm text-gray-700">
                    I agree to the
                    <a href="#" class="text-netpay-primary-blue hover:underline">Privacy Policy</a>
                    *
                  </span>
                </label>
                <div
                  class="error-message"
                  *ngIf="isFieldInvalid(agreementsForm, 'privacyPolicyAccepted')"
                >
                  {{ getFieldError(agreementsForm, 'privacyPolicyAccepted') }}
                </div>

                <label class="flex items-start space-x-3">
                  <input
                    type="checkbox"
                    formControlName="processingAgreementAccepted"
                    class="mt-1 h-5 w-5 text-netpay-primary-blue border-gray-300 rounded focus:ring-netpay-primary-blue"
                  />
                  <span class="text-sm text-gray-700">
                    I agree to the
                    <a href="#" class="text-netpay-primary-blue hover:underline"
                      >Payment Processing Agreement</a
                    >
                    *
                  </span>
                </label>
                <div
                  class="error-message"
                  *ngIf="isFieldInvalid(agreementsForm, 'processingAgreementAccepted')"
                >
                  {{ getFieldError(agreementsForm, 'processingAgreementAccepted') }}
                </div>

                <label class="flex items-start space-x-3">
                  <input
                    type="checkbox"
                    formControlName="marketingConsent"
                    class="mt-1 h-5 w-5 text-netpay-primary-blue border-gray-300 rounded focus:ring-netpay-primary-blue"
                  />
                  <span class="text-sm text-gray-700">
                    I would like to receive marketing communications from Netpay
                  </span>
                </label>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Navigation Buttons -->
      <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
        <button
          *ngIf="activeIndex > 0"
          (click)="previousStep()"
          type="button"
          class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"
        >
          Previous
        </button>
        <div *ngIf="activeIndex === 0"></div>

        <button
          *ngIf="activeIndex < steps.length - 1"
          (click)="nextStep()"
          type="button"
          class="px-6 py-3 bg-netpay-primary-blue text-white rounded-lg hover:bg-netpay-accent-blue transition-colors"
        >
          Next Step
        </button>

        <button
          *ngIf="activeIndex === steps.length - 1"
          (click)="submitForm()"
          type="button"
          [disabled]="isSubmitting"
          class="px-8 py-3 bg-netpay-teal text-white rounded-lg hover:bg-netpay-primary-blue transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center"
        >
          <span
            *ngIf="isSubmitting"
            class="inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"
          ></span>
          {{ isSubmitting ? 'Submitting...' : 'Submit Application' }}
        </button>
      </div>

      <!-- Loading Template -->
      <ng-template #loadingTemplate>
        <div class="flex items-center justify-center py-12">
          <div
            class="animate-spin rounded-full h-12 w-12 border-b-2 border-netpay-primary-blue"
          ></div>
          <span class="ml-3 text-gray-600">Loading...</span>
        </div>
      </ng-template>
    </div>
  </div>

  <!-- Success Dialog -->
  <div
    *ngIf="showSuccessDialog"
    class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"
  >
    <div class="bg-white rounded-lg shadow-xl p-6 m-4 max-w-md w-full">
      <div class="text-center">
        <div
          class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4"
        >
          <svg class="h-6 w-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 13l4 4L19 7"
            ></path>
          </svg>
        </div>
        <h3 class="text-lg font-medium text-gray-900 mb-2">Application Submitted Successfully!</h3>
        <p class="text-sm text-gray-500 mb-1">Your merchant application has been received.</p>
        <p class="text-sm text-gray-500 mb-4">
          Reference ID: <span class="font-medium text-netpay-primary-blue">{{ merchantId }}</span>
        </p>
        <button
          (click)="closeSuccessDialog()"
          class="w-full bg-netpay-primary-blue text-white px-4 py-2 rounded-lg hover:bg-netpay-accent-blue transition-colors"
        >
          Close
        </button>
      </div>
    </div>
  </div>
</div>
